# AI Swarm Caddyfile
# Automatic HTTPS reverse proxy configuration
#
# Environment variables:
#   PORTAL_DOMAIN - Portal domain (default: localhost)
#   WEB_DOMAIN - Marketing site domain (default: localhost)
#   TEMPORAL_DOMAIN - Temporal UI domain (optional)
#   ACME_EMAIL - Email for Let's Encrypt notifications
#   ACME_CA - Override ACME server (for staging/ZeroSSL)

{
	# Global options
	email {$ACME_EMAIL:admin@example.com}
	
	# Uncomment for staging/ZeroSSL to avoid rate limits
	# acme_ca {$ACME_CA}
}

# Portal (Dashboard)
{$PORTAL_DOMAIN:localhost} {
	reverse_proxy portal:3000
}

# Web (Marketing Site)
{$WEB_DOMAIN:localhost}:443 {
	reverse_proxy web:3000
}

# Temporal UI (Optional - uncomment to expose)
# {$TEMPORAL_DOMAIN:temporal.localhost} {
# 	reverse_proxy temporal-ui:8080
# }

# Health check endpoint
:8080 {
	respond /health 200
}
